# ğŸ”Œ SchÃ©mas de CÃ¢blage - KawaPet

## Vue d'Ensemble

```
                           KawaPet Wiring Diagram
                           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                 â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚   â”‚              ROUND DISPLAY FOR XIAO                   â”‚    â”‚
    â”‚   â”‚                                                       â”‚    â”‚
    â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
    â”‚   â”‚  â”‚                                                 â”‚ â”‚    â”‚
    â”‚   â”‚  â”‚             Ã‰cran GC9A01 240Ã—240                â”‚ â”‚    â”‚
    â”‚   â”‚  â”‚                  (Visage)                       â”‚ â”‚    â”‚
    â”‚   â”‚  â”‚                                                 â”‚ â”‚    â”‚
    â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
    â”‚   â”‚                                                       â”‚    â”‚
    â”‚   â”‚   [Touch CST816S]  [RTC BM8563]  [Charge TP4056]     â”‚    â”‚
    â”‚   â”‚                                                       â”‚    â”‚
    â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚    â”‚
    â”‚   â”‚              â”‚    XIAO ESP32-S3    â”‚                 â”‚    â”‚
    â”‚   â”‚              â”‚    (enfichable)     â”‚                 â”‚    â”‚
    â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚    â”‚
    â”‚   â”‚                        â”‚                              â”‚    â”‚
    â”‚   â”‚   JST 1.25mm â”€â”€â–º[BAT]  â”‚                              â”‚    â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚                            â”‚                                    â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
    â”‚            â”‚                               â”‚                    â”‚
    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”            â”‚
    â”‚     â”‚   I2C Bus   â”‚               â”‚     PWM       â”‚            â”‚
    â”‚     â”‚  (GPIO5/6)  â”‚               â”‚   (GPIO1)     â”‚            â”‚
    â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
    â”‚            â”‚                               â”‚                    â”‚
    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                       â”‚                    â”‚
    â”‚     â”‚             â”‚                       â”‚                    â”‚
    â”‚  â”Œâ”€â”€â”´â”€â”€â”       â”Œâ”€â”€â”´â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”‚
    â”‚  â”‚Trillâ”‚       â”‚ IMU â”‚              â”‚  Servo    â”‚              â”‚
    â”‚  â”‚ Bar â”‚       â”‚BMI  â”‚              â”‚  FT90B    â”‚              â”‚
    â”‚  â”‚     â”‚       â”‚160  â”‚              â”‚           â”‚              â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â”‚   (Dos)      (Orientation)         (Mouvement tÃªte)            â”‚
    â”‚                                                                 â”‚
    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
    â”‚                    â”‚   LiPo      â”‚                             â”‚
    â”‚                    â”‚  3.7V       â”‚                             â”‚
    â”‚                    â”‚  3000mAh    â”‚                             â”‚
    â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
    â”‚                                                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Connexion XIAO + Round Display

Le XIAO ESP32-S3 s'enfiche **directement** sur le Round Display (plug-and-play).

```
          Round Display (vue de dessus)
         â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
        â•±                                  â•²
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
       â”‚    â”‚                        â”‚      â”‚
       â”‚    â”‚     Ã‰cran Rond         â”‚      â”‚
       â”‚    â”‚      240Ã—240           â”‚      â”‚
       â”‚    â”‚                        â”‚      â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
       â”‚                                    â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
       â”‚  â”‚      XIAO ESP32-S3           â”‚  â”‚
       â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
       â”‚  â”‚   â”‚      USB-C          â”‚â—„â”€â”€â”€â”¼â”€â”€â”¼â”€â”€ Vers extÃ©rieur
       â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â”‚                                    â”‚
       â”‚  [BAT]â—„â”€â”€â”€ JST 1.25mm â”€â”€â”€â–º LiPo   â”‚
       â”‚  [ON/OFF]                          â”‚
        â•²                                  â•±
         â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

**âš ï¸ Important :**
- USB-C du XIAO vers l'**extÃ©rieur** du Round Display
- Interrupteur sur **ON**
- Batterie sur le connecteur **BAT** du Round Display (pas sur le XIAO)

---

## Bus I2C

### Connexions

```
                    I2C Bus (3.3V)
                    
    XIAO ESP32-S3                    PÃ©riphÃ©riques
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    GPIO5 (D4/SDA) â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ Trill Bar (SDA)
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€ GY-BMI160 (SDA)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€ [Touch CST816S - interne]
    
    GPIO6 (D5/SCL) â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ Trill Bar (SCL)
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€ GY-BMI160 (SCL)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€ [Touch CST816S - interne]
    
    3.3V â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ Trill Bar (VCC)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€ GY-BMI160 (VCC)
    
    GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ Trill Bar (GND)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€ GY-BMI160 (GND)
```

### Adresses I2C

| PÃ©riphÃ©rique | Adresse | Notes |
|--------------|---------|-------|
| CST816S (Touch) | 0x15 | IntÃ©grÃ© au Round Display |
| BM8563 (RTC) | 0x51 | IntÃ©grÃ© au Round Display |
| Trill Bar | 0x20 | Configurable 0x20-0x28 |
| GY-BMI160 | 0x68 | 0x69 si SDO = HIGH |

---

## Connexion Trill Bar

```
    Trill Bar                      XIAO (via Round Display)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â—‹ â—‹ â—‹ â—‹ â—‹ â—‹ â—‹    â”‚          VCC (3.3V) â†â”€â”€â”€â”€ 3V3
    â”‚  Zone tactile     â”‚          GND â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND
    â”‚  (26 canaux)      â”‚          SDA â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GPIO5 (D4)
    â”‚                   â”‚          SCL â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GPIO6 (D5)
    â”‚  [VCC][GND][SDA][SCL]
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    (4 pins Ã  connecter)
```

**CÃ¢blage :**
| Trill Bar | Fil | XIAO |
|-----------|-----|------|
| VCC | Rouge | 3V3 |
| GND | Noir | GND |
| SDA | Jaune | GPIO5 (D4) |
| SCL | Blanc | GPIO6 (D5) |

---

## Connexion GY-BMI160

```
    GY-BMI160                      XIAO (via Round Display)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   BMI160        â”‚            VCC (3.3V) â†â”€â”€â”€â”€ 3V3
    â”‚                 â”‚            GND â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND
    â”‚  [VCC]          â”‚            SDA â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GPIO5 (D4)
    â”‚  [GND]          â”‚            SCL â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GPIO6 (D5)
    â”‚  [SCL]          â”‚            INT1 (optionnel) â† Non connectÃ©
    â”‚  [SDA]          â”‚            INT2 (optionnel) â† Non connectÃ©
    â”‚  [INT1]         â”‚
    â”‚  [INT2]         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CÃ¢blage :**
| GY-BMI160 | Fil | XIAO |
|-----------|-----|------|
| VCC | Rouge | 3V3 |
| GND | Noir | GND |
| SDA | Jaune | GPIO5 (D4) |
| SCL | Blanc | GPIO6 (D5) |

---

## Connexion Servo FT90B

```
    Servo FT90B                    XIAO
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚            Signal (Orange) â†â”€â”€ GPIO1 (D0)
    â”‚   â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®   â”‚            VCC (Rouge) â†â”€â”€â”€â”€â”€â”€ VBAT (3.7-4.2V)
    â”‚   â”‚  Servo  â”‚   â”‚            GND (Marron) â†â”€â”€â”€â”€â”€ GND
    â”‚   â”‚  Motor  â”‚   â”‚
    â”‚   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯   â”‚
    â”‚                 â”‚
    â”‚  [Signal][VCC][GND]
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    CÃ¢ble 3 fils (connecteur JR/Futaba)
```

**âš ï¸ Alimentation du Servo :**

Le servo FT90B fonctionne de 3V Ã  4.8V. Deux options :

**Option A - Direct LiPo (recommandÃ©) :**
```
    LiPo 3.7V â”€â”€â”€â”€â”¬â”€â”€â”€â”€ Round Display (BAT)
                  â”‚
                  â””â”€â”€â”€â”€ Servo VCC (via fil supplÃ©mentaire)
```

**Option B - Via rÃ©gulateur (si dispo) :**
```
    3.3V du XIAO â”€â”€â”€â”€ Servo VCC
    (âš ï¸ LimitÃ© en courant, peut causer des resets)
```

---

## SchÃ©ma Complet SimplifiÃ©

```
                              USB-C
                                â”‚
                                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     ROUND DISPLAY                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚                  XIAO ESP32-S3                    â”‚ â”‚
    â”‚  â”‚                                                   â”‚ â”‚
    â”‚  â”‚  GPIO1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Servo Signal  â”‚ â”‚
    â”‚  â”‚  GPIO5 â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º I2C SDA       â”‚ â”‚
    â”‚  â”‚  GPIO6 â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º I2C SCL       â”‚ â”‚
    â”‚  â”‚              â”‚                                    â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                 â”‚                                       â”‚
    â”‚  3V3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Trill + IMU VCC  â”‚
    â”‚  GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Trill + IMU GND  â”‚
    â”‚                 â”‚                                       â”‚
    â”‚  [BAT] â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€ LiPo 3.7V â”€â”€â–º Servo VCC        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”œâ”€â”€â–º Trill Bar (SDA/SCL) â”€â”€â–º Caresses
                      â”‚
                      â””â”€â”€â–º GY-BMI160 (SDA/SCL) â”€â”€â–º Orientation
```

---

## RÃ©sumÃ© des Connexions

| Signal | GPIO XIAO | Fonction |
|--------|-----------|----------|
| TFT_CS | GPIO2 (D1) | SPI - Chip Select Ã©cran |
| TFT_DC | GPIO4 (D3) | SPI - Data/Command Ã©cran |
| TFT_SCLK | GPIO7 (D8) | SPI - Clock Ã©cran |
| TFT_MOSI | GPIO9 (D10) | SPI - Data Ã©cran |
| I2C_SDA | GPIO5 (D4) | I2C - Data (Trill, IMU, Touch) |
| I2C_SCL | GPIO6 (D5) | I2C - Clock (Trill, IMU, Touch) |
| SERVO_PWM | GPIO1 (D0) | PWM - Commande servo |

---

## Notes de CÃ¢blage

### Longueur des CÃ¢bles

| Connexion | Longueur max recommandÃ©e |
|-----------|--------------------------|
| I2C | 20 cm (sans rÃ©pÃ©teur) |
| Servo | 30 cm |

### QualitÃ© des Connexions

- Utiliser des cÃ¢bles Dupont de bonne qualitÃ©
- Ã‰viter les fils trop fins (min 26 AWG)
- SÃ©curiser les connexions avec de la colle chaude si nÃ©cessaire

### Protection

- Ne **jamais** brancher la batterie Ã  l'envers
- VÃ©rifier la polaritÃ© du connecteur JST avant branchement
- Le Round Display a une protection contre l'inversion, mais mieux vaut prÃ©venir
